{"version":3,"file":"main.js","sourceRoot":"","sources":["../src/main.ts"],"names":[],"mappings":"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","sourcesContent":["import BluebirdPromise from \"bluebird-lst\"\nimport { readJson } from \"fs-extra-p\"\nimport { Lazy } from \"lazy-val\"\nimport * as path from \"path\"\nimport { getConfig, validateConfig } from \"read-config-file\"\nimport { deepAssign } from \"read-config-file/out/deepAssign\"\nimport \"source-map-support/register\"\nimport { Configuration, Plugin, Rule } from \"webpack\"\nimport merge from \"webpack-merge\"\nimport { configureTypescript } from \"./configurators/ts\"\nimport { configureVue } from \"./configurators/vue/vue\"\nimport { ConfigurationEnv, ConfigurationType, ElectronWebpackConfiguration, PackageMetadata, PartConfiguration } from \"./core\"\nimport { BaseTarget } from \"./targets/BaseTarget\"\nimport { MainTarget } from \"./targets/MainTarget\"\nimport { BaseRendererTarget, RendererTarget } from \"./targets/RendererTarget\"\nimport { getFirstExistingFile, orNullIfFileNotExist } from \"./util\"\n\nexport { ElectronWebpackConfiguration } from \"./core\"\n\nconst _debug = require(\"debug\")\n\n// noinspection JSUnusedGlobalSymbols\nexport function getAppConfiguration(env: ConfigurationEnv) {\n  return BluebirdPromise.filter([configure(\"main\", env), configure(\"renderer\", env)], it => it != null)\n}\n\n// noinspection JSUnusedGlobalSymbols\nexport function getMainConfiguration(env: ConfigurationEnv) {\n  return configure(\"main\", env)\n}\n\n// noinspection JSUnusedGlobalSymbols\nexport function getRendererConfiguration(env: ConfigurationEnv) {\n  return configure(\"renderer\", env)\n}\n\n// in the future, if need, isRenderer = true arg can be added\n// noinspection JSUnusedGlobalSymbols\nexport function getDllConfiguration(env: ConfigurationEnv) {\n  return configure(\"renderer-dll\", env)\n}\n\n// noinspection JSUnusedGlobalSymbols\nexport async function getTestConfiguration(env: ConfigurationEnv) {\n  const configurator = await createConfigurator(\"test\", env)\n  return await configurator.configure({\n    testComponents: path.join(process.cwd(), \"src/renderer/components/testComponents.ts\"),\n  })\n}\n\nexport class WebpackConfigurator {\n  readonly projectDir: string\n\n  private electronVersionPromise = new Lazy(() => getInstalledElectronVersion(this.projectDir))\n\n  readonly isRenderer: boolean\n  readonly isProduction: boolean\n  readonly isTest = this.type === \"test\"\n\n  readonly sourceDir: string\n  readonly commonSourceDirectory: string\n\n  readonly debug = _debug(`electron-webpack:${this.type}`)\n\n  private _configuration: Configuration | null = null\n\n  get config(): Configuration {\n    return this._configuration!!\n  }\n\n  readonly rules: Array<Rule> = []\n  readonly plugins: Array<Plugin> = []\n\n  // js must be first - e.g. iview has two files loading-bar.js and loading-bar.vue - when we require \"loading-bar\", js file must be resolved and not vue\n  readonly extensions: Array<string> = [\".js\", \".json\", \".node\"]\n\n  private _electronVersion: string | null = null\n\n  get electronVersion(): string {\n    return this._electronVersion!!\n  }\n\n  readonly entryFiles: Array<string> = []\n\n  constructor(readonly type: ConfigurationType, readonly env: ConfigurationEnv, readonly electronWebpackConfiguration: ElectronWebpackConfiguration, readonly metadata: PackageMetadata) {\n    if (electronWebpackConfiguration.renderer === undefined) {\n      electronWebpackConfiguration.renderer = {}\n    }\n    if (electronWebpackConfiguration.main === undefined) {\n      electronWebpackConfiguration.main = {}\n    }\n\n    if (metadata.dependencies == null) {\n      metadata.dependencies = {}\n    }\n    if (metadata.devDependencies == null) {\n      metadata.devDependencies = {}\n    }\n\n    this.projectDir = electronWebpackConfiguration.projectDir || process.cwd()\n    this.isRenderer = type.startsWith(\"renderer\")\n    process.env.BABEL_ENV = type\n\n    this.isProduction = this.env.production == null ? process.env.NODE_ENV === \"production\" : this.env.production\n\n    this.debug(`isProduction: ${this.isProduction}`)\n\n    this.sourceDir = this.getSourceDirectory(this.type)!!\n\n    const commonSourceDirectory = this.electronWebpackConfiguration.commonSourceDirectory\n    this.commonSourceDirectory = commonSourceDirectory == null ? path.join(this.projectDir, \"src\", \"common\") : path.resolve(this.projectDir, commonSourceDirectory)\n  }\n\n  /**\n   * Returns null if code processing for type is disabled.\n   */\n  getSourceDirectory(type: ConfigurationType): string | null {\n    const part = this.getPartConfiguration(type)\n    if (part === null || (part != null && part.sourceDirectory === null)) {\n      // part or sourceDirectory is explicitly set to null\n      return null\n    }\n\n    const result = part == null ? null : part.sourceDirectory\n    if (result == null) {\n      return path.join(this.projectDir, \"src\", type.startsWith(\"renderer\") || type === \"test\" ? \"renderer\" : type)\n    }\n    else {\n      return path.resolve(this.projectDir, result)\n    }\n  }\n\n  getPartConfiguration(type: ConfigurationType): PartConfiguration | null | undefined {\n    if (type === \"main\") {\n      return this.electronWebpackConfiguration.main\n    }\n    else {\n      return this.electronWebpackConfiguration.renderer\n    }\n  }\n\n  get commonDistDirectory() {\n    return path.join(this.projectDir, \"dist\")\n  }\n\n  hasDependency(name: string) {\n    return name in this.metadata.dependencies || this.hasDevDependency(name)\n  }\n\n  hasDevDependency(name: string) {\n    return name in this.metadata.devDependencies\n  }\n\n  /**\n   * Returns the names of devDependencies that match a given string or regex.\n   * If no matching dependencies are found, an empty array is returned.\n   *\n   * @return list of matching dependency names, e.g. `['babel-preset-react', 'babel-preset-stage-0']`\n   */\n  getMatchingDevDependencies(options: GetMatchingDevDependenciesOptions = {}) {\n    const includes = options.includes || []\n    const excludes = new Set(options.excludes || [])\n    return Object.keys(this.metadata.devDependencies)\n      .filter(name => !excludes.has(name) && includes.some(prefix => name.startsWith(prefix)))\n  }\n\n  async configure(entry?: { [key: string]: any } | null) {\n    this._configuration = {\n      context: this.projectDir,\n      devtool: this.isProduction || this.isTest ? \"nosources-source-map\" : \"eval-source-map\",\n      externals: this.computeExternals(),\n      node: {\n        __dirname: !this.isProduction,\n        __filename: !this.isProduction,\n      },\n      output: {\n        filename: \"[name].js\",\n        chunkFilename: \"[name].bundle.js\",\n        libraryTarget: \"commonjs2\",\n        path: path.join(this.commonDistDirectory, this.type)\n      },\n      target: this.isTest ? \"node\" : `electron-${this.type === \"renderer-dll\" ? \"renderer\" : this.type}` as any,\n      resolve: {\n        alias: {\n          \"@\": this.sourceDir,\n          common: this.commonSourceDirectory,\n        },\n        extensions: this.extensions,\n      },\n      module: {\n        rules: this.rules,\n      },\n      plugins: this.plugins,\n    }\n\n    if (entry != null) {\n      this._configuration.entry = entry\n    }\n\n    // if electronVersion not specified, use latest\n    this._electronVersion = this.electronWebpackConfiguration.electronVersion || await this.electronVersionPromise.value || \"1.8.2\"\n    const target = (() => {\n      switch (this.type) {\n        case \"renderer\": return new RendererTarget()\n        case \"renderer-dll\": return new BaseRendererTarget()\n        case \"test\": return new BaseRendererTarget()\n        case \"main\": return new MainTarget()\n        default: return new BaseTarget()\n      }\n    })()\n    this.debug(`Target class: ${target.constructor.name}`)\n    target.configureRules(this)\n    await BluebirdPromise.all([target.configurePlugins(this), configureTypescript(this)])\n    configureVue(this)\n\n    if (this.debug.enabled) {\n      this.debug(`\\n\\n${this.type} config:` + JSON.stringify(this._configuration, null, 2) + \"\\n\\n\")\n    }\n\n    if (this.config.entry == null) {\n      this.entryFiles.push((await computeEntryFile(this.sourceDir, this.projectDir))!!)\n      this.config.entry = {\n        [this.type]: this.entryFiles,\n      }\n\n      const mainConfiguration = this.electronWebpackConfiguration.main || {}\n      let extraEntries = mainConfiguration.extraEntries\n      if (this.type === \"main\" && extraEntries != null) {\n        if (typeof extraEntries === \"string\") {\n          extraEntries = [extraEntries]\n        }\n\n        if (Array.isArray(extraEntries)) {\n          for (const p of extraEntries) {\n            this.config.entry[path.basename(p, path.extname(p))] = p\n          }\n        }\n        else {\n          Object.assign(this.config.entry, extraEntries)\n        }\n      }\n    }\n\n    this._configuration = await this.applyCustomModifications(this.config);\n\n    return this.config;\n  }\n\n  private applyCustomModifications(config: Configuration) {\n    const applyCustom = (filepath: string) => {\n      const customModule = require(path.join(this.projectDir, filepath));\n      if (typeof customModule === 'function') {\n        return customModule(config);\n      } else {\n        return merge.smart(config, customModule);\n      }\n    };\n\n    if (this.type === 'renderer' && this.electronWebpackConfiguration.renderer && this.electronWebpackConfiguration.renderer.webpackConfig) {\n      return applyCustom(this.electronWebpackConfiguration.renderer.webpackConfig);\n    }\n\n    if (this.type === 'renderer-dll' && this.electronWebpackConfiguration.renderer && this.electronWebpackConfiguration.renderer.webpackDllConfig ) {\n      return applyCustom(this.electronWebpackConfiguration.renderer.webpackDllConfig);\n    }\n\n    if (this.type === 'main' && this.electronWebpackConfiguration.main && this.electronWebpackConfiguration.main.webpackConfig) {\n      return applyCustom(this.electronWebpackConfiguration.main.webpackConfig);\n    }\n\n    return config;\n  }\n\n  private computeExternals() {\n    const whiteListedModules = new Set(this.electronWebpackConfiguration.whiteListedModules || [])\n    if (this.isRenderer) {\n      whiteListedModules.add(\"vue\")\n    }\n\n    const filter = (name: string) => !name.startsWith(\"@types/\") && (whiteListedModules == null || !whiteListedModules.has(name))\n    const externals: Array<string> = Object.keys(this.metadata.dependencies).filter(filter)\n    externals.push(\"electron\")\n    externals.push(\"webpack\")\n    // because electron-devtools-installer specified in the devDependencies, but required in the index.dev\n    externals.push(\"electron-devtools-installer\")\n    if (this.type === \"main\") {\n      externals.push(\"webpack/hot/log-apply-result\")\n      externals.push(\"electron-webpack/out/electron-main-hmr/HmrClient\")\n      externals.push(\"source-map-support/source-map-support.js\")\n    }\n\n    if (this.electronWebpackConfiguration.externals != null) {\n      return externals.concat(this.electronWebpackConfiguration.externals)\n    }\n\n    return externals\n  }\n}\n\nconst schemeDataPromise = new Lazy(() => readJson(path.join(__dirname, \"..\", \"scheme.json\")))\n\nexport async function createConfigurator(type: ConfigurationType, env: ConfigurationEnv | null) {\n  if (env != null) {\n    // allow to pass as `--env.autoClean=false` webpack arg\n    const _env: any = env\n    for (const name of [\"minify\", \"autoClean\", \"production\"]) {\n      if (_env[name] === \"true\") {\n        _env[name] = true\n      }\n      else if (_env[name] === \"false\") {\n        _env[name] = false\n      }\n    }\n  }\n\n  if (env == null) {\n     env = {}\n   }\n\n  const projectDir = (env.configuration || {}).projectDir || process.cwd()\n  const packageMetadata = await orNullIfFileNotExist(readJson(path.join(projectDir, \"package.json\")))\n  const electronWebpackConfig = ((await getConfig({\n    packageKey: \"electronWebpack\",\n    configFilename: \"electron-webpack\",\n    projectDir,\n    packageMetadata: new Lazy(() => BluebirdPromise.resolve(packageMetadata))\n  })) || {} as any).result || {}\n  if (env.configuration != null) {\n    deepAssign(electronWebpackConfig, env.configuration)\n  }\n\n  await validateConfig(electronWebpackConfig, schemeDataPromise, message => {\n    return `${message}\n\nHow to fix:\n1. Open https://webpack.electron.build/options\n2. Search the option name on the page.\n  * Not found? The option was deprecated or not exists (check spelling).\n  * Found? Check that the option in the appropriate place. e.g. \"sourceDirectory\" only in the \"main\" or \"renderer\", not in the root.\n`\n  })\n  return new WebpackConfigurator(type, env, electronWebpackConfig, packageMetadata)\n}\n\nexport async function configure(type: ConfigurationType, env: ConfigurationEnv | null): Promise<Configuration | null> {\n  const configurator = await createConfigurator(type, env)\n  const sourceDir = configurator.sourceDir\n  // explicitly set to null - do not handle at all and do not show info message\n  if (sourceDir === null) {\n    return null\n  }\n  else {\n    return await configurator.configure()\n  }\n}\n\nasync function computeEntryFile(srcDir: string, projectDir: string): Promise<string | null> {\n  const candidates: Array<string> = []\n  for (const ext of [\"ts\", \"js\", \"tsx\"]) {\n    for (const name of [\"index\", \"main\", \"app\"]) {\n      candidates.push(`${name}.${ext}`)\n    }\n  }\n\n  const file = await getFirstExistingFile(candidates, srcDir)\n  if (file == null) {\n    throw new Error(`Cannot find entry file ${path.relative(projectDir, path.join(srcDir, \"index.ts\"))} (or main.ts, or app.ts, or index.js, or main.js, or app.js)`)\n  }\n  return file\n}\n\nasync function getInstalledElectronVersion(projectDir: string) {\n  for (const name of [\"electron\", \"electron-prebuilt\", \"electron-prebuilt-compile\"]) {\n    try {\n      return (await readJson(path.join(projectDir, \"node_modules\", name, \"package.json\"))).version\n    }\n    catch (e) {\n      if (e.code !== \"ENOENT\") {\n        throw e\n      }\n    }\n  }\n}\n\nexport interface GetMatchingDevDependenciesOptions {\n  /**\n   * The list of prefixes to include, e.g. `[\"babel-preset-\"]`.\n   */\n  includes?: Array<string>\n  /**\n   * The list of names to exclude.\n   */\n  excludes?: Array<string>\n}\n"]}
